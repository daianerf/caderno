{
  "hash": "ab43d698f81c35190e7ad5c5809542fc",
  "result": {
    "engine": "knitr",
    "markdown": "---\nformat: html\neditor: visual\n---\n\n\n\n\n# **Análise de Correlação**\n\nA análise de correlação é utilizada para verificar a intensidade e a direção da relação linear entre duas variáveis contínuas. Seu principal objetivo é avaliar até que ponto as variáveis se associam — ou seja, se tendem a variar juntas de forma proporcional.\n\nEssa análise pode indicar:\n\n-   **Correlação positiva**: quando o aumento de uma variável está associado ao aumento da outra;\n\n-   **Correlação negativa**: quando o aumento de uma variável está associado à diminuição da outra;\n\n-   **Ausência de correlação**: quando não há uma relação linear evidente entre as variáveis.\n\nO coeficiente de correlação de Pearson é a medida mais comum e varia entre -1 e +1:\n\n-   Valores próximos de **+1** indicam forte correlação positiva;\n\n-   Valores próximos de **-1** indicam forte correlação negativa;\n\n-   Valores próximos de **0** indicam correlação fraca ou inexistente.\n\nÉ importante destacar que a correlação não implica causalidade, ou seja, uma variável pode estar associada à outra sem que necessariamente uma cause a outra.\n\n### Carregamento de pacotes\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(readxl)\nlibrary(ggplot2)\n```\n:::\n\n\n\n\n### Importando o conjunto de dados\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nestande <- read_excel(\"dados-diversos.xlsx\", \"estande\")\n```\n:::\n\n\n\n\n### Visualização gráfica\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nestande |>\n  ggplot(aes(trat, nplants))+\n  geom_point()+\n  facet_wrap(~ exp)+\n  ylim(0,max(estande$nplants))+\n  geom_smooth(se =  F)\n```\n\n::: {.cell-output-display}\n![](correlacao_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\n\n\n## **Ajustando modelo linear simples e quadratico**\n\nPara ajustar modelos de regressão linear — seja simples ou quadrático — utiliza-se a função `lm()` no R. Essa função recebe como argumentos uma **fórmula** que define a relação entre a variável dependente e a(s) variável(is) independente(s), além do conjunto de dados a ser utilizado.\n\nPor exemplo, para um modelo linear simples, a fórmula seria `y ~ x`, onde `y` é a variável resposta e `x` é a variável explicativa. Para um modelo quadrático, a fórmula pode ser `y ~ x + I(x^2)`, incluindo o termo ao quadrado de `x`.\n\nO modelo ajustado é armazenado como um objeto do tipo `lm`, que pode ser examinado com a função `summary()`. Esse resumo fornece os coeficientes estimados, valores-p, estatísticas de ajuste (como o R²) e outros diagnósticos úteis.\n\n### Coeficiente de Determinação (R²)\n\nO **R²** representa a proporção da variação da variável resposta que é explicada pelo modelo ajustado. Seu valor varia entre 0 e 1:\n\n-   **R² = 0**: o modelo não explica nenhuma variação nos dados;\n\n-   **R² = 1**: o modelo explica toda a variação observada.\n\nQuanto maior o R², melhor o modelo se ajusta aos dados, indicando maior capacidade explicativa por parte das variáveis independentes.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nestande2 <- estande |>\n  filter(exp ==2) |>\n  group_by(trat) |>\n  summarise(mean_nplants = mean(nplants))\n  \nestande2|>\n  ggplot(aes(trat, mean_nplants))+\n  geom_point()+\n  #geom_line()\n  geom_smooth(formula = y ~ poly(x, 2), method = \"lm\", color = \"black\")+\n  annotate(geom = \"text\", \n           x = 25, y = 70,\n           label = \"y = 66.3 - 1.777x + 0.0222x2\n           R2 = 0.0.88\")\n```\n\n::: {.cell-output-display}\n![](correlacao_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n\n\n## Modelo Quadrático\n\nDiferente do modelo linear, que descreve a relação entre duas variáveis por meio de uma linha reta, o modelo quadrático permite identificar padrões não lineares, com comportamento curvo.\n\nPara ajustar um modelo quadrático no R, utiliza-se a função `lm()`, incluindo o termo ao quadrado da variável independente na fórmula. Por exemplo, para modelar a relação entre uma variável dependente `y` e uma independente `x`.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nestande2 <- estande2 |>\n  mutate(trat2 = trat^2)\n  m1 <- lm(mean_nplants ~ trat, data = estande2)\nsummary(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = mean_nplants ~ trat, data = estande2)\n\nResiduals:\n     1      2      3      4      5      6 \n12.764 -2.134 -6.782 -3.327 -4.669  4.147 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  60.9857     4.5505  13.402 0.000179 ***\ntrat         -0.7007     0.2012  -3.483 0.025294 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 8.117 on 4 degrees of freedom\nMultiple R-squared:  0.752,\tAdjusted R-squared:   0.69 \nF-statistic: 12.13 on 1 and 4 DF,  p-value: 0.02529\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nhist(m1$residuals)\n```\n\n::: {.cell-output-display}\n![](correlacao_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nm2 <- lm(mean_nplants ~ trat + trat2,\n         data = estande2)\nsummary(m2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = mean_nplants ~ trat + trat2, data = estande2)\n\nResiduals:\n      1       2       3       4       5       6 \n 7.4484 -4.4200 -6.4386  1.0739  3.0474 -0.7111 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 66.30156    4.70800  14.083 0.000776 ***\ntrat        -1.77720    0.62263  -2.854 0.064878 .  \ntrat2        0.02223    0.01242   1.790 0.171344    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 6.517 on 3 degrees of freedom\nMultiple R-squared:  0.8801,\tAdjusted R-squared:  0.8001 \nF-statistic: 11.01 on 2 and 3 DF,  p-value: 0.04152\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nAIC(m1, m2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   df      AIC\nm1  3 45.72200\nm2  4 43.36151\n```\n\n\n:::\n:::\n\n\n\n\n## **Duas variáveis resposta**\n\n### Ajuste de Modelo Linear Simples e Quadrático\n\nPara ajustar modelos de regressão linear, seja simples ou quadrático, utiliza-se a função `lm()` no R. Essa função recebe como argumentos uma fórmula que define a relação entre a variável dependente e a(s) variável(is) independente(s), além do conjunto de dados a ser utilizado.\n\nPor exemplo, para um modelo linear simples, a fórmula seria `y ~ x`, onde `y` é a variável resposta e `x` é a variável explicativa. Para um modelo quadrático, a fórmula pode ser `y ~ x + I(x^2)`, incluindo o termo ao quadrado de `x`.\n\nO modelo ajustado é armazenado como um objeto do tipo `lm`, que pode ser examinado com a função `summary()`. Esse resumo fornece os coeficientes estimados, valores-p, estatísticas de ajuste (como o R²) e outros diagnósticos úteis.\n\n#### Importando o conjunto de dados\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmofo <- read_excel(\"dados-diversos.xlsx\", \"mofo\")\n```\n:::\n\n\n\n\n#### Visualizando os dados\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmofo |>\n  ggplot(aes(inc, yld))+\n  geom_point()+\n  geom_smooth(se = F, method = \"lm\")+\n  facet_wrap(~ study)\n```\n\n::: {.cell-output-display}\n![](correlacao_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n\n\nFiltrando o experimento 1 (study = 1):\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmofo1 <- mofo |>\n  filter(study ==1)\nmofo1\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 13 × 5\n   study treat   inc   scl   yld\n   <dbl> <dbl> <dbl> <dbl> <dbl>\n 1     1     1    76  2194  2265\n 2     1     2    53  1663  2618\n 3     1     3    42  1313  2554\n 4     1     4    37  1177  2632\n 5     1     5    29   753  2820\n 6     1     6    42  1343  2799\n 7     1     7    55  1519  2503\n 8     1     8    40   516  2967\n 9     1     9    26   643  2965\n10     1    10    18   400  3088\n11     1    11    27   643  3044\n12     1    12    28   921  2925\n13     1    13    36  1196  2867\n```\n\n\n:::\n:::\n\n\n\n\nA função `cor.test()` é utilizada para calcular o **coeficiente de correlação** entre duas variáveis numéricas. Além de fornecer o valor da correlação (como o coeficiente de Pearson), ela também realiza um **teste de hipótese** para verificar se essa correlação é **estatisticamente significativa**, ou seja, se é improvável que tenha ocorrido ao acaso.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncor.test(mofo1$inc, mofo1$yld)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPearson's product-moment correlation\n\ndata:  mofo1$inc and mofo1$yld\nt = -6.8451, df = 11, p-value = 2.782e-05\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n -0.9699609 -0.6921361\nsample estimates:\n       cor \n-0.8999278 \n```\n\n\n:::\n:::\n\n\n\n\nFiltrando o experimento 2:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmofo1 <- mofo |>\n  filter(study ==2)\nmofo1\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 13 × 5\n   study treat   inc   scl   yld\n   <dbl> <dbl> <dbl> <dbl> <dbl>\n 1     2     1    76  1331  2257\n 2     2     2    44   756  2393\n 3     2     3    24   338  2401\n 4     2     4    33   581  2568\n 5     2     5    37   588  2320\n 6     2     6    34   231  2308\n 7     2     7    31   925  2389\n 8     2     8    16   119  2614\n 9     2     9    10   394  2681\n10     2    10     8   206  2694\n11     2    11    15   275  2674\n12     2    12     7   131  2666\n13     2    13    19   588  2454\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncor.test(mofo1$inc, mofo1$yld)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPearson's product-moment correlation\n\ndata:  mofo1$inc and mofo1$yld\nt = -4.6638, df = 11, p-value = 0.0006894\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n -0.9426562 -0.4790750\nsample estimates:\n       cor \n-0.8149448 \n```\n\n\n:::\n:::\n\n\n\n\nFiltrando o experimento 4:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmofo1 <- mofo |>\n  filter(study ==4)\nmofo1\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 13 × 5\n   study treat   inc   scl   yld\n   <dbl> <dbl> <dbl> <dbl> <dbl>\n 1     4     1    69  6216  1893\n 2     4     2    39  2888  2451\n 3     4     3    41  2272  2232\n 4     4     4    39  2868  2609\n 5     4     5    40  2412  2383\n 6     4     6    40  2372  2480\n 7     4     7    44  3424  2577\n 8     4     8    43  1744  2367\n 9     4     9    26  1456  2769\n10     4    10    29  1732  2907\n11     4    11    30  1080  2298\n12     4    12    34  1592  2976\n13     4    13    44  3268  2200\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncor.test(mofo1$inc, mofo1$yld)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPearson's product-moment correlation\n\ndata:  mofo1$inc and mofo1$yld\nt = -3.7242, df = 11, p-value = 0.003357\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n -0.9194503 -0.3327077\nsample estimates:\n       cor \n-0.7467931 \n```\n\n\n:::\n:::\n\n\n\n\nFiltrando o experimento 3:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmofo1 <- mofo |>\n  filter(study ==3)\nmofo1\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 13 × 5\n   study treat   inc   scl   yld\n   <dbl> <dbl> <dbl> <dbl> <dbl>\n 1     3     1    65  5013  2839\n 2     3     2    33  3619  3375\n 3     3     3    40  2325  3264\n 4     3     4    35  2588  3301\n 5     3     5    48  3969  3220\n 6     3     6    31  1556  3321\n 7     3     7    39  3175  3229\n 8     3     8    25  1763  3517\n 9     3     9    26  2894  3595\n10     3    10    21   350  3702\n11     3    11    23   419  3652\n12     3    12    25   644  3608\n13     3    13    33  2850  3334\n```\n\n\n:::\n:::\n\n\n\n\n### Matrizes de Correlação\n\nA matriz de correlação é uma tabela que exibe os coeficientes de correlação entre todos os pares de variáveis de um conjunto de dados. Cada célula da matriz indica a força e a direção da relação entre duas variáveis, geralmente usando o coeficiente de correlação de Pearson, embora outras medidas (como Spearman ou Kendall) também possam ser utilizadas, conforme o contexto da análise.\n\nGerando matriz de correlação para as variáveis selecionadas:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmofo1 <- mofo |>\n  filter(study ==3)\nmofo1\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 13 × 5\n   study treat   inc   scl   yld\n   <dbl> <dbl> <dbl> <dbl> <dbl>\n 1     3     1    65  5013  2839\n 2     3     2    33  3619  3375\n 3     3     3    40  2325  3264\n 4     3     4    35  2588  3301\n 5     3     5    48  3969  3220\n 6     3     6    31  1556  3321\n 7     3     7    39  3175  3229\n 8     3     8    25  1763  3517\n 9     3     9    26  2894  3595\n10     3    10    21   350  3702\n11     3    11    23   419  3652\n12     3    12    25   644  3608\n13     3    13    33  2850  3334\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncor.test(mofo1$inc, mofo1$yld)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPearson's product-moment correlation\n\ndata:  mofo1$inc and mofo1$yld\nt = -10.9, df = 11, p-value = 3.105e-07\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n -0.9872663 -0.8579544\nsample estimates:\n      cor \n-0.956692 \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\n\ncor(mofo1[, 3:5])\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n           inc        scl       yld\ninc  1.0000000  0.8441514 -0.956692\nscl  0.8441514  1.0000000 -0.836512\nyld -0.9566920 -0.8365120  1.000000\n```\n\n\n:::\n:::\n\n\n\n\n### Gráficos de Correlação\n\nPara visualizar matrizes de correlação, o pacote `corrplot` é uma ferramenta amplamente utilizada no R. Ele oferece diversas funções para explorar e representar visualmente as relações entre variáveis em um conjunto de dados, facilitando a identificação de padrões de correlação.\n\nPrincipais funções do pacote corrplot:\n\n-   `corr.test()`: realiza testes estatísticos para matrizes de correlação, calculando coeficientes de correlação, valores-p e intervalos de confiança, permitindo avaliar a significância das correlações.\n\n-   `corrplot()`: gera gráficos que exibem a matriz de correlação com diferentes estilos visuais. Permite personalizar o tipo de gráfico, as cores, adicionar os valores numéricos dos coeficientes, além de possibilitar agrupamentos hierárquicos.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmofo1 <- mofo |>\n  filter(study ==3)\nmofo1\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 13 × 5\n   study treat   inc   scl   yld\n   <dbl> <dbl> <dbl> <dbl> <dbl>\n 1     3     1    65  5013  2839\n 2     3     2    33  3619  3375\n 3     3     3    40  2325  3264\n 4     3     4    35  2588  3301\n 5     3     5    48  3969  3220\n 6     3     6    31  1556  3321\n 7     3     7    39  3175  3229\n 8     3     8    25  1763  3517\n 9     3     9    26  2894  3595\n10     3    10    21   350  3702\n11     3    11    23   419  3652\n12     3    12    25   644  3608\n13     3    13    33  2850  3334\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncor.test(mofo1$inc, mofo1$yld)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPearson's product-moment correlation\n\ndata:  mofo1$inc and mofo1$yld\nt = -10.9, df = 11, p-value = 3.105e-07\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n -0.9872663 -0.8579544\nsample estimates:\n      cor \n-0.956692 \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npcor <- cor(mofo1[, 3:5])\n\nlibrary(corrplot)\ncorrplot(pcor, method = 'number', type = \"lower\")\n```\n\n::: {.cell-output-display}\n![](correlacao_files/figure-html/unnamed-chunk-22-1.png){width=672}\n:::\n:::\n\n\n\n\n### Modelo de Kendall\n\nO coeficiente de correlação de Kendall é uma medida não paramétrica que avalia a associação entre duas variáveis ordinais ou variáveis medidas em escala ordinal. Assim como o coeficiente de Pearson, o coeficiente de Kendall varia entre -1 e 1, indicando a direção e a força da relação.\n\nPor ser não paramétrico, o método de Kendall é mais robusto em situações onde os dados não seguem uma relação linear ou quando as variáveis não possuem distribuição normal, sendo uma alternativa adequada para analisar associações em dados ordinais ou com distribuições não normais.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmofo1 <- mofo |>\n  filter(study ==3)\nmofo1\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 13 × 5\n   study treat   inc   scl   yld\n   <dbl> <dbl> <dbl> <dbl> <dbl>\n 1     3     1    65  5013  2839\n 2     3     2    33  3619  3375\n 3     3     3    40  2325  3264\n 4     3     4    35  2588  3301\n 5     3     5    48  3969  3220\n 6     3     6    31  1556  3321\n 7     3     7    39  3175  3229\n 8     3     8    25  1763  3517\n 9     3     9    26  2894  3595\n10     3    10    21   350  3702\n11     3    11    23   419  3652\n12     3    12    25   644  3608\n13     3    13    33  2850  3334\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nshapiro.test(mofo1$inc)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tShapiro-Wilk normality test\n\ndata:  mofo1$inc\nW = 0.87111, p-value = 0.05412\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nshapiro.test(mofo1$yld)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tShapiro-Wilk normality test\n\ndata:  mofo1$yld\nW = 0.92193, p-value = 0.2663\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncor.test(mofo1$inc, mofo1$yld, method = \"spearman\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tSpearman's rank correlation rho\n\ndata:  mofo1$inc and mofo1$yld\nS = 715.97, p-value = 7.166e-08\nalternative hypothesis: true rho is not equal to 0\nsample estimates:\n       rho \n-0.9669458 \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npcor <- cor(mofo1[, 3:5], method = \"spearman\")\n\nlibrary(corrplot)\ncorrplot(pcor, method = 'number', type = \"lower\")\n```\n\n::: {.cell-output-display}\n![](correlacao_files/figure-html/unnamed-chunk-27-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "correlacao_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}