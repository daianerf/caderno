{
  "hash": "d4d05670d0d061a495e4d1756b57b7a1",
  "result": {
    "engine": "knitr",
    "markdown": "---\nformat: html\neditor: visual\n---\n\n\n\n\n# **Análises estatísticas**\n\n## **Tipos de testes para análise estatística:**\n\nNesta aula, serão abordados os tipos de análise estatística em função da quantidade e da natureza das variáveis independentes (níveis dos fatores), bem como do número de tratamentos ou grupos experimentais a serem comparados.\n\n## Teste T\n\nO *teste* *t* é um dos testes estatísticos mais utilizados para comparar médias entre grupos. Ele é especialmente útil quando queremos verificar se duas amostras apresentam diferenças estatisticamente significativas. Como todo teste estatístico, o *teste t* também tem como produto a medida do valor de *p* (calculado a probabilidade da diferença encontrada (entre as médias) terem sido por acaso).\n\nNo RStudio, esse teste pode ser realizado de forma simples usando a função `t.test()`.\n\nTrabalhando um conjunto de dados e aplicando o “Teste t”.\n\n### Teste t para amostras independentes\n\nO teste t para amostras independentes avalia se há evidência estatística suficiente para afirmar que as médias dos dois grupos são diferentes. Esse teste assume que os dois grupos são independentes entre si, isto é, os valores de um grupo não influenciam os do outro.\n\n**Exemplo:** Experimento com o objetivo de avaliar o efeito do micronutriente magnésio (Mg), adicionado na solução do solo cultivado com plantas, no manejo de uma doença. O experimento foi conduzido em delineamento inteiramente casualizado com 10 repetições. Um dos tratamentos é o controle \"*control*\" (testemunha, sem a aplicação do micronutriente. O segundo é Magnésio \"*Mg2*\", onde houve aplicação do mineral. Em cada uma das repetições foi obtido um valor médio do comprimento (mm) de lesões.\n\nO conjunto de dados utilizado neste exemplo está disponível em uma planilha online no *Google Sheets*.Para acessar esses dados diretamente no R, foi utilizada a biblioteca `gsheet`, que permite importar planilhas do *Google Sheets* de forma prática.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#Primeiramente, carregou-se a biblioteca com o comando:\nlibrary(gsheet)\n\n#Em seguida, os dados foram lidos a partir do link da planilha online usando a função gsheet2tbl, que converte a planilha em um data frame no R:\ndat_mg <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=983033137#gid=983033137\")\n```\n:::\n\n\n\n\nCom os dados carregados, foi feita uma visualização gráfica utilizando a biblioteca `ggplot2`. O gráfico gerado é do tipo *jitter plot*, que ajuda a visualizar a dispersão dos dados ao longo dos diferentes tratamentos (trat) em relação à variável de interesse (comp):\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\ndat_mg |> \n  ggplot(aes(trat, comp))+\n  geom_jitter(width=0.1)\n```\n\n::: {.cell-output-display}\n![](teste_t_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\n\n\nEsse tipo de gráfico é útil para observar possíveis padrões, sobreposição de valores e variações entre os grupos experimentais.\n\nAgora, vamos iniciar a análise dos dados e extrair estatísticas que resumem o conjunto, tanto em relação à tendência central quanto à dispersão.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\ndata2 <- dat_mg |>\n  group_by(trat) |>\n  summarise(\n    mean_com = mean(comp),\n    sd_comp = sd(comp),\n    var_comp = var(comp),\n    n = n(),\n    se_comp = sd_comp / sqrt(n - 1),\n    ci = se_comp * qt(0,025, df = 9))\ndata2\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 7\n  trat    mean_com sd_comp var_comp     n se_comp    ci\n  <chr>      <dbl>   <dbl>    <dbl> <int>   <dbl> <dbl>\n1 Mg2         10.5    1.54     2.39    10   0.515  -Inf\n2 control     15.7    1.27     1.61    10   0.424  -Inf\n```\n\n\n:::\n:::\n\n\n\n\nAqui visualizaremos os dados em gráfico de barras vertical com erro padrão.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata2 |> \n  ggplot(aes(trat, mean_com)) +\n  geom_col(width = 0.5,\n           fill = \"#99E89D\") +\n  geom_errorbar(aes(\n    ymin = mean_com - se_comp,\n    ymax = mean_com + se_comp),\n    width = 0.1) +\n  ylim(0,20) +\nlabs(x = \"Tratamentos\", y = \"Tamanho médio das lesões (mm)\")\n```\n\n::: {.cell-output-display}\n![](teste_t_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n\n\nIntervalo de confiança:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata2 |> \n  ggplot(aes(trat, mean_com)) +\n  geom_col(width = 0.5, fill = \"#99E89D\") +\n  geom_errorbar(aes(\n    ymin = mean_com - ci,\n    ymax = mean_com + ci),\n    width = 0.1) +\n  ylim(0,20) +\nlabs(x = \"Tratamentos\", y = \"Tamanho médio das lesões  (mm)\")\n```\n\n::: {.cell-output-display}\n![](teste_t_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n\n\nAo utilizar `?t.test`, o R exibe a documentação dessa função, explicando seus argumentos, funcionamento e exemplos de uso. Esse teste pode ser empregado posteriormente para analisar se as diferenças observadas entre os tratamentos são estatisticamente significativas.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# ?t.test #mostra como esse teste funciona\n```\n:::\n\n\n\n\nApós importar e visualizar os dados sobre tratamentos com magnésio, procedeu-se com a transformação do formato dos dados e aplicação de um teste estatístico para comparação entre os grupos.\n\n#### Transformação dos dados (pivotagem)\n\nInicialmente, os dados foram reorganizados com a função `pivot_wider()` da biblioteca `tidyr`, com o objetivo de converter a estrutura do dataset do formato longo (onde os valores de tratamento estão em uma única coluna) para o formato largo (em que cada tratamento ocupa uma coluna distinta com seus respectivos valores):\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\nlibrary(tidyr)  # <- Adicione isso para usar pivot_wider()\ndat_mg2 <- dat_mg |>\n  pivot_wider (names_from = trat, values_from = comp) |> #Transformando o formato dos dados: O que era uma coluna \"longa\" vai virar várias colunas \"largas\".\n  ##   Pivot (passar de longo para largo)\n  \n  dplyr::select(-rep)\n```\n:::\n\n\n\n\nCom isso, a coluna `trat`, que antes indicava os diferentes grupos de tratamento (por exemplo, \"control\" e \"Mg2\"), é desmembrada em colunas separadas, facilitando a aplicação de testes estatísticos comparativos. A coluna `rep`, que representa as repetições experimentais, foi removida por não ser necessária nessa etapa da análise.\n\nUtilizou-se a função `t.test()` para comparar as médias dos dois tratamentos: `control` (sem magnésio) e `Mg2` (tratamento com magnésio):\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nattach(dat_mg2)\n\nt_results <- t.test(control, Mg2)\nt_results\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tWelch Two Sample t-test\n\ndata:  control and Mg2\nt = 8.1549, df = 17.354, p-value = 2.423e-07\nalternative hypothesis: true difference in means is not equal to 0\n95 percent confidence interval:\n 3.825607 6.490393\nsample estimates:\nmean of x mean of y \n   15.678    10.520 \n```\n\n\n:::\n:::\n\n\n\n\n#### Interpretação do valor de *p*\n\nO resultado do teste inclui o valor de *p* (*p-value*), que representa a probabilidade de observar uma diferença entre as médias tão grande quanto (ou maior que) a encontrada nos dados, assumindo que a hipótese nula seja verdadeira.\n\n-   **Hipótese nula (H₀):** as médias dos dois grupos são iguais.\n\n**Hipótese alternativa (H₁):** as médias dos grupos são diferentes\n\nSe o valor de *p* for muito pequeno (geralmente menor que 0,05), rejeita-se a hipótese nula. Isso significa que a diferença observada entre os grupos é estatisticamente significativa, e aceita-se a hipótese alternativa: os grupos são diferentes entre si.\n\nPortanto, o teste t aplicado permite concluir se a aplicação de magnésio (Mg2) gerou um efeito significativo em relação ao controle.\n\n#### Análise e Interpretação do Teste t com Apoio de Pacotes no R\n\nApós a realização do teste t para comparar dois tratamentos experimentais aplicados em plantas (por exemplo, controle e suplementação com magnésio), foram utilizadas ferramentas adicionais no R para interpretar, organizar e visualizar os resultados de forma mais clara e acessível.\n\nO pacote `report` foi utilizado para gerar uma interpretação automática e em linguagem natural dos resultados do teste t. Esse pacote é útil para descrever os principais resultados estatísticos em formato descritivo, ideal para relatórios e publicações.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(report) #Pacote para explicar os resultados das análises\nreport(t_results)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nEffect sizes were labelled following Cohen's (1988) recommendations.\n\nThe Welch Two Sample t-test testing the difference between control and Mg2\n(mean of x = 15.68, mean of y = 10.52) suggests that the effect is positive,\nstatistically significant, and large (difference = 5.16, 95% CI [3.83, 6.49],\nt(17.35) = 8.15, p < .001; Cohen's d = 3.65, 95% CI [2.14, 5.12])\n```\n\n\n:::\n:::\n\n\n\n\nA função `report()` aplica uma análise interpretativa ao objeto do teste t (`t_results`), exibindo informações como estatísticas do teste, valor de *p*, médias dos grupos comparados e interpretação textual (por exemplo, se a diferença entre os grupos é significativa ou não).\n\nComo o objeto `t_results` foi gerado com os dados em formato longo, **não foi necessário fazer transformações adicionais** para usar a função `report()`.\n\n#### Realização do teste t com o pacote `rstatix`\n\nOutra forma de realizar o teste t, especialmente útil para análises com estrutura de dados em formato longo, é com o pacote `rstatix`. Ele fornece uma sintaxe clara e compatível com o `tidyverse`.\n\nAqui, `comp ~ trat` indica que estamos comparando a variável de resposta `comp` entre os níveis da variável `trat`. O resultado é armazenado no objeto `test`, que pode ser usado para visualização.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(rstatix)\ntest <- t_test(comp ~ trat, data = dat_mg)\ntest\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 8\n  .y.   group1  group2    n1    n2 statistic    df           p\n* <chr> <chr>   <chr>  <int> <int>     <dbl> <dbl>       <dbl>\n1 comp  control Mg2       10    10      8.15  17.4 0.000000242\n```\n\n\n:::\n:::\n\n\n\n\n#### Visualização gráfica com valor de *p* usando `ggpubr`\n\nPara complementar a análise, foi construído um gráfico boxplot com o pacote `ggpubr`, que facilita a geração de gráficos estatísticos com suporte a *p-values*.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggpubr)\n\np <- ggboxplot(\n  dat_mg, x = \"trat\", y = \"comp\",\n  color = \"trat\", palette = \"jco\")\nprint(p)\n```\n\n::: {.cell-output-display}\n![](teste_t_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n\n\nEm seguida, o valor de *p* obtido no teste t foi adicionado manualmente ao gráfico com `stat_pvalue_manual()`, indicando se há diferença estatística entre os grupos:\n\nO parâmetro `y.position = 18` define a altura em que o valor de *p* será exibido no gráfico. A função `ylim(0, 20)` ajusta os limites do eixo y para acomodar melhor os dados e o texto.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#add p-value manually\np + stat_pvalue_manual(test, label = \"p\",\n  y.position = 18)+\n    ylim(0,20)+\n  labs(x = \"Tratamento\",\n       y = \"Comprimento (mm)\")\n```\n\n::: {.cell-output-display}\n![](teste_t_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggsave(\"plot2.png\", bg = \"white\") #Por fim, o gráfico foi salvo em um arquivo de imagem.\n```\n:::\n\n\n\n\n#### Verificação de Suposições para o Teste t: Normalidade e Homogeneidade de Variâncias\n\nAo aplicar o *teste t* para comparação de médias entre dois grupos independentes, é fundamental verificar se os dados atendem às suposições básicas desse teste paramétrico. Essas suposições incluem:\n\n-   **Distribuição normal dos dados em cada grupo**\n\n-   **Homogeneidade das variâncias entre os grupos**\n\nO não atendimento dessas condições pode invalidar os resultados do teste ou exigir ajustes na sua aplicação.\n\n#### Teste de Normalidade: `shapiro.test()`\n\nA normalidade dos dados foi avaliada para cada grupo separadamente com o **teste de Shapiro-Wilk**, por meio da função `shapiro.test()`:\n\nEsse teste verifica se os dados seguem uma **distribuição normal**. A hipótese nula (H₀) é de que os dados são normalmente distribuídos.\n\n-   Se o **valor de p \\> 0,05**, não se rejeita H₀ → os dados são considerados normalmente distribuídos;\n\n-   Se o **valor de p \\< 0,05**, rejeita-se H₀ → os dados não seguem distribuição normal.\n\nAlém do teste, foram gerados histogramas para visualização da distribuição:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#Testando a normalidade dos dados\nshapiro.test(Mg2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tShapiro-Wilk normality test\n\ndata:  Mg2\nW = 0.97269, p-value = 0.9146\n```\n\n\n:::\n\n```{.r .cell-code}\nshapiro.test(control)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tShapiro-Wilk normality test\n\ndata:  control\nW = 0.93886, p-value = 0.5404\n```\n\n\n:::\n\n```{.r .cell-code}\nhist(Mg2)\n```\n\n::: {.cell-output-display}\n![](teste_t_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n\n```{.r .cell-code}\nhist(control)\n```\n\n::: {.cell-output-display}\n![](teste_t_files/figure-html/unnamed-chunk-13-2.png){width=672}\n:::\n:::\n\n\n\n\nOs histogramas ajudam a identificar visualmente desvios da normalidade, como assimetrias ou presença de outliers.\n\n**Análise visual da premissa de normalidade**: A análise visual da premissa de normalidade é realizada por qqplot (QQ-Plot), que permite verificar se uma amostra segue uma distribuição gaussiana. Podemos simplesmente fazer usando as funções qqnorm() e qqline() para cada umas das variáveis analisadas.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nqqnorm (Mg2)\nqqline(Mg2)\n```\n\n::: {.cell-output-display}\n![](teste_t_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nqqnorm(control)\nqqline(control)\n```\n\n::: {.cell-output-display}\n![](teste_t_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\n\n\n#### Teste de Homogeneidade de Variâncias: `var.test()`\n\nPara verificar se as variâncias dos dois grupos são semelhantes (homogêneas), utilizou-se o **teste de F** com a função `var.test()`:\n\nA hipótese nula (H₀) nesse teste é de que as variâncias dos dois grupos são iguais.\n\n-   Se o **valor de p \\> 0,05**, considera-se que as variâncias são homogêneas.\n\n-   Se o **valor de p \\< 0,05**, as variâncias são diferentes (heterocedásticas).\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#Testando a homogeneidade das variâncias\nvar.test(dat_mg2$Mg2,\n         dat_mg2$control) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tF test to compare two variances\n\ndata:  dat_mg2$Mg2 and dat_mg2$control\nF = 1.4781, num df = 9, denom df = 9, p-value = 0.5698\nalternative hypothesis: true ratio of variances is not equal to 1\n95 percent confidence interval:\n 0.3671417 5.9508644\nsample estimates:\nratio of variances \n          1.478111 \n```\n\n\n:::\n:::\n\n\n\n\n#### Ajuste do Teste t com base nas variâncias\n\nSe o teste indicar variâncias homogêneas, pode-se aplicar o teste t com o argumento `var.equal = TRUE` (padrão).\\\nNo entanto, se for detectada heterogeneidade de variâncias, o teste t deve ser ajustado com:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nt_results <- t.test(control, Mg2, var.equal = FALSE)\n# O parâmetro var.equal = FALSE ativa a correção de Welch, que ajusta os graus de liberdade do teste, tornando-o mais robusto quando as variâncias são diferentes.\n```\n:::\n\n\n\n\n### Teste T para amostras dependentes\n\n**Exemplo:** Foi realizado um experimento com o objetivo de verificar o impacto do uso de uma escala na acurácia e precisão de estimativas visuais de severidade feitas por avaliadores. A hipótese testada foi de que o uso de uma escala diagramática auxilia na obtenção de estimativas mais acuradas em comparação com avaliações feitas sem esse recurso. Dez avaliadores foram selecionados aleatoriamente, e cada um realizou duas avaliações. Foram coletadas cinco variáveis relacionadas à concordância das estimativas. Como as medições foram repetidas para os mesmos avaliadores em momentos distintos, tratam-se de amostras dependentes.\n\n#### Comparando Dois Grupos (teste t pareado)\n\nAqui, os dados são importados diretamente de uma planilha online no Google Sheets com o pacote `gsheet`. A planilha contém escores de acurácia medidos antes e depois de uma intervenção (avaliados como `Unaided` e `Aided1`).\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#importação dos dados\nescala <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=1729131173#gid=1729131173\")\nhead(escala)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 7\n  assessment rater acuracia precisao vies_geral vies_sistematico vies_constante\n  <chr>      <chr>    <dbl>    <dbl>      <dbl>            <dbl>          <dbl>\n1 Unaided    A         0.81     0.83       0.98             1.19           0.11\n2 Unaided    B         0.72     0.73       0.99             0.92          -0.11\n3 Unaided    C         0.4      0.71       0.78             1.16           0.73\n4 Unaided    D         0.82     0.82       1                0.95          -0.01\n5 Unaided    E         0.75     0.75       0.99             1.1            0.07\n6 Unaided    F         0.45     0.75       0.92             0.8            0.34\n```\n\n\n:::\n:::\n\n\n\n\n### Teste t pareado\n\nEsse teste verifica se houve diferença significativa entre os dois momentos de avaliação (antes e depois da ajuda), utilizando o `t_test()` do pacote `rstatix`.\n\nA opção `paired = TRUE` indica que são as mesmas pessoas avaliadas duas vezes, e `var.equal = FALSE` corrige o teste caso as variâncias sejam diferentes (teste de Welch).\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntest <- t_test(acuracia ~ assessment,\n       data = escala,\n       paired = TRUE,\n       var.equal = FALSE)\ntest\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 8\n  .y.      group1 group2     n1    n2 statistic    df       p\n* <chr>    <chr>  <chr>   <int> <int>     <dbl> <dbl>   <dbl>\n1 acuracia Aided1 Unaided    10    10      4.42     9 0.00167\n```\n\n\n:::\n:::\n\n\n\n\n**Visualização:** É gerado um boxplot para visualizar a distribuição das acurácias por tipo de avaliação (`Unaided` vs `Aided1`).\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nescala |> \n  ggplot(aes(assessment, acuracia))+\n         geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](teste_t_files/figure-html/unnamed-chunk-20-1.png){width=672}\n:::\n:::\n\n\n\n\n#### Testando suposições\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nunaided <- escala |>\n  filter(assessment == \"Unaided\") |>\n  pull(acuracia)\n\naided <- escala |>\n  filter(assessment == \"Aided\") |>\n  pull(acuracia)\n\n\nif (length(unaided) >= 2 && length(aided) >= 2) {\n  var.test(unaided, aided) # Homogeneidade de variâncias\n} else {\n  message(\"Número de observações insuficiente em um dos grupos.\")\n}\n\nhist(unaided)\n```\n\n::: {.cell-output-display}\n![](teste_t_files/figure-html/unnamed-chunk-21-1.png){width=672}\n:::\n\n```{.r .cell-code}\nif (length(aided) > 1) {\n  hist(aided)\n} else {\n  message(\"Não há dados suficientes para gerar o histograma de 'aided'.\")\n}     # Visualização da distribuição\n\nshapiro.test(unaided) # Normalidade\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tShapiro-Wilk normality test\n\ndata:  unaided\nW = 0.7748, p-value = 0.007155\n```\n\n\n:::\n:::\n\n\n\n\nVerifica se os dados atendem às premissas do teste t (normalidade e variâncias iguais).\n\n-   Se **normalidade** falha → usar teste **não paramétrico**.\n\n-   Se **variâncias são diferentes**, continuar com `var.equal = FALSE`.\n\n### **Teste não paramétrico equivalente (Wilcoxon):**\n\nUm teste não paramétrico não faz nenhuma suposição sobre a distribuição da população ou tamanho da amostra. O `Wilcox.test` é o teste para dados não paramétricos equivalente ao *teste t* para dados paramétricos. o teste de `Wilcoxon` é usado para testar se as medianas das amostras são iguais nos casos em que a suposição de normalidade não é satisfeita ou quando não for possível checar essa suposição.\n\nUsar Wilcoxon se os dados não forem normais. O primeiro é o equivalente ao t pareado, o segundo ao t para amostras independentes.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# wilcox.test(unaided, aided)             # Wilcoxon pareado\n# wilcox.test(unaided, aided, paired = FALSE) # Mann-Whitney (independente)\n```\n:::\n",
    "supporting": [
      "teste_t_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}