{
  "hash": "3ef31aef270c17340d223420990c75fc",
  "result": {
    "engine": "knitr",
    "markdown": "---\nformat: html\neditor: visual\n---\n\n\n\n\n\n# **ANOVA** (Análise de Variância)\n\nÉ um teste estatístico utilizado para comparar as médias de três ou mais grupos e verificar se há diferenças estatisticamente significativas entre elas. Ao invés de comparar pares de médias individualmente, como no teste t, a ANOVA avalia simultaneamente a variabilidade entre os grupos e dentro dos grupos.\n\nA ANOVA usa o teste F para testar a hipótese nula de que as médias populacionais são iguais contra a hipótese alternativa de que pelo menos uma média é diferente das demais.\n\n## **Anova com 1 fator (***One-way Anova*)\n\nÉ uma técnica estatística utilizada para comparar as médias de três ou mais grupos que diferem em relação a um único fator (ou variável independente). Esse fator pode representar, por exemplo, diferentes tratamentos, cultivares, doses de um produto ou condições experimentais.\n\nO objetivo é verificar se há diferença significativa entre as médias dos grupos. A hipótese nula assume que todas as médias são iguais, enquanto a hipótese alternativa indica que pelo menos uma delas é diferente.\n\n**Exemplo:** Experimento com um fator e em delineamento inteiramente casualizado (DIC) para comparar o crescimento micelial de diferentes espécies de um fungo fitopatogênico. A resposta a ser estudada é a TCM = taxa de crescimento micelial.\n\n### Importando o conjunto de dados:\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(readxl)\nmicelial <- read_excel(\"dados-diversos.xlsx\", \"micelial\")\nhead(micelial)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 3\n  especie   rep   tcm\n  <chr>   <dbl> <dbl>\n1 Fasi        1  1.5 \n2 Fasi        2  1.59\n3 Fasi        3  1.52\n4 Fasi        4  1.52\n5 Fasi        5  1.6 \n6 Fasi        6  1.7 \n```\n\n\n:::\n:::\n\n\n\n\n\n### Carregando pacotes:\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(dplyr)\nlibrary(ggplot2)\n```\n:::\n\n\n\n\n\n### **Visualização dos dados**:\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmicelial |>\n  ggplot(aes(x = especie, y = tcm)) +\n  geom_boxplot(utlier.color = NA, fill = \"#1A8C8C\", color = \"black\") +\n   geom_jitter(width = 0.1)+\n  labs(\n    x = \"Espécie Fúngica\",\n    y = \"Taxa de Crescimento Micelial\"\n  )\n```\n\n::: {.cell-output-display}\n![](anova_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n\n\n\n### **Modelo usando `aov()`**\n\nPara verificar os dados usando anova, um novo modelo para atribuir a função `aov()` contendo os argumentos tratamento em função da variável resposta deve ser criado (ex.: tcm \\~ espécie), o banco de dados referido deve ser enunciado após o argumento separado por vírgula seguido do nome data = nome do conjunto de dados (ex.: micelial). Depois disso, pede um quadro de resumo do novo modelo criado.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\naov1 <- aov(tcm ~ especie, data = micelial)\nsummary(aov1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n            Df Sum Sq Mean Sq F value   Pr(>F)    \nespecie      4 1.4696  0.3674   19.63 2.03e-07 ***\nResiduals   25 0.4679  0.0187                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\naov2 <- lm(tcm ~ especie, data = micelial) # Outra forma de fazer a ANOVA\naov2\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = tcm ~ especie, data = micelial)\n\nCoefficients:\n(Intercept)  especieFaus  especieFcor  especieFgra  especieFmer  \n      1.572       -0.335       -0.250       -0.660       -0.145  \n```\n\n\n:::\n:::\n\n\n\n\n\n#### **Testando as premissas**\n\n##### **Testes de Normalidade e Homocedasticidade**\n\n**Teste de Normalidade**\n\nA normalidade dos dados é uma condição importante para muitos testes estatísticos. Ela garante que os resultados das análises, como ANOVA e teste t, sejam confiáveis, pois esses métodos assumem que os dados vêm de uma população com distribuição normal.\n\n**Teste de Homocedasticidade**\n\nNa ANOVA, é necessário que os grupos comparados tenham variâncias semelhantes. Essa condição é chamada de homocedasticidade. Se as variâncias forem muito diferentes (heterocedasticidade), os resultados do teste F podem ser comprometidos.\n\nPara testar as premissas, é necessário instalar e carregar o pacote `performance` e o pacote `DHARMa`.\n\nO pacote `performance` permite checar as premissas `(check_)`, já o pacote `DHARMA` (*Distributed Hierarchical Accumulation of Residuals for Generalized Linear Models in R*) é para visualizar os dados pelo diagnóstico do resíduo. O pacote `DHARMa` permite faz uma comparação dos resíduos simulados, que são gerados pelo pacote, com os resíduos observados e ver graficamente quando a distribuição dos dados não é normal e/ou quando há variação heterocedástica.\n\nApós isso, deve-se fazer o teste de normalidade dos resíduos com a interação entre a anova e os resíduos.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(performance)\ncheck_heteroscedasticity(aov1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nOK: Error variance appears to be homoscedastic (p = 0.880).\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncheck_normality(aov1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nOK: residuals appear as normally distributed (p = 0.878).\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(DHARMa)\nhist (aov1$residuals) #Ou hist(residuals(aov1))\n```\n\n::: {.cell-output-display}\n![](anova_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Mostra a distribuição visual dos resíduos.\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nqqnorm(aov1$residuals)\nqqline(aov1$residuals)\n```\n\n::: {.cell-output-display}\n![](anova_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(simulateResiduals(aov1))\n```\n\n::: {.cell-output-display}\n![](anova_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nshapiro.test(aov1$residuals) #Ou shapiro.test(residuals(aov1)) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tShapiro-Wilk normality test\n\ndata:  aov1$residuals\nW = 0.9821, p-value = 0.8782\n```\n\n\n:::\n:::\n\n\n\n\n\nO teste verifica a seguinte hipótese:\n\n-   **Hipótese nula (H₀)**: Os dados seguem distribuição normal;\n\n-   **Hipótese alternativa (H₁)**: Os dados não seguem distribuição normal.\n\nComparamos o p-valor com um nível de significância comum, geralmente **α = 0,05**:\n\n**p-valor = 0,8782 \\> 0,05** → Não rejeitamos a hipótese nula\n\nHomogeneidade de variâncias:\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Teste de Bartlett – mais sensível a desvios da normalidade\nbartlett.test(tcm ~ especie, data = micelial)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tBartlett test of homogeneity of variances\n\ndata:  tcm by especie\nBartlett's K-squared = 4.4367, df = 4, p-value = 0.3501\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Teste de Levene – mais robusto à violação da normalidade\nlibrary(car)\nleveneTest(tcm ~ especie, data = micelial)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nLevene's Test for Homogeneity of Variance (center = median)\n      Df F value Pr(>F)\ngroup  4  1.7563 0.1693\n      25               \n```\n\n\n:::\n:::\n\n\n\n\n\n##### Interpretação dos Resultados:\n\n-   **p-valor \\> 0,05** → Não há evidência de variâncias diferentes → Premissa atendida.\n\n-   **p-valor \\< 0,05** → As variâncias são significativamente diferentes → Premissa violada.\n\n#### Comparações múltiplas e médias ajustadas\n\n**Pacote “emmeans”**\n\n(“*estimated marginal means*”, ou médias marginais estimadas) é usado para realizar testes de comparação de médias entre grupos, ajustando para outros fatores importantes que podem influenciar as médias. O pacote é particularmente útil em modelos lineares generalizados (GLM).\n\n`emmeans(...)`: calcula as médias ajustadas (médias marginais) para cada grupo de `especie` com base no modelo.\n\nImportante para comparações entre grupos quando há mais de 2 níveis.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(emmeans)\nm <- emmeans(aov2, ~ especie)\nm\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n especie emmean     SE df lower.CL upper.CL\n Fasi     1.572 0.0559 25    1.457     1.69\n Faus     1.237 0.0559 25    1.122     1.35\n Fcor     1.322 0.0559 25    1.207     1.44\n Fgra     0.912 0.0559 25    0.797     1.03\n Fmer     1.427 0.0559 25    1.312     1.54\n\nConfidence level used: 0.95 \n```\n\n\n:::\n:::\n\n\n\n\n\n**Testes post-hoc (comparações entre grupos)**\n\n**Pacote “multcomp” -** `multcomp`: para fazer comparações múltiplas entre grupos.\n\nTestes simultâneos e intervalos de confiança para hipóteses lineares gerais em modelos paramétricos, incluindo efeitos lineares, lineares generalizados, lineares mistos e modelos de sobrevivência.\n\n**Pacote “multcompView” -** `multcompView`: para gerar **letras compactas**, indicando quais grupos são diferentes.\n\nConverte um vetor lógico ou um vetor de valores-*p* ou uma matriz de correlação, diferença ou distância em uma exibição identificando os pares para os quais as diferenças não foram significativamente diferentes.\n\n**Cld -** Extrai e exibe informações sobre todas as comparações pareadas de médias de mínimos quadrados.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(multcomp)\nlibrary(multcompView)\n\ncld(m)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n especie emmean     SE df lower.CL upper.CL .group\n Fgra     0.912 0.0559 25    0.797     1.03  1    \n Faus     1.237 0.0559 25    1.122     1.35   2   \n Fcor     1.322 0.0559 25    1.207     1.44   2   \n Fmer     1.427 0.0559 25    1.312     1.54   23  \n Fasi     1.572 0.0559 25    1.457     1.69    3  \n\nConfidence level used: 0.95 \nP value adjustment: tukey method for comparing a family of 5 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npairs(m) #Mostra os testes pareados (comparação entre pares de grupos).\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n contrast    estimate    SE df t.ratio p.value\n Fasi - Faus    0.335 0.079 25   4.241  0.0023\n Fasi - Fcor    0.250 0.079 25   3.165  0.0302\n Fasi - Fgra    0.660 0.079 25   8.356  <.0001\n Fasi - Fmer    0.145 0.079 25   1.836  0.3765\n Faus - Fcor   -0.085 0.079 25  -1.076  0.8169\n Faus - Fgra    0.325 0.079 25   4.115  0.0031\n Faus - Fmer   -0.190 0.079 25  -2.405  0.1469\n Fcor - Fgra    0.410 0.079 25   5.191  0.0002\n Fcor - Fmer   -0.105 0.079 25  -1.329  0.6761\n Fgra - Fmer   -0.515 0.079 25  -6.520  <.0001\n\nP value adjustment: tukey method for comparing a family of 5 estimates \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npwpm(m) #Exibe uma matriz com as médias na diagonal e comparações entre os grupos fora dela.\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n        Fasi    Faus    Fcor    Fgra    Fmer\nFasi [1.572]  0.0023  0.0302  <.0001  0.3765\nFaus   0.335 [1.237]  0.8169  0.0031  0.1469\nFcor   0.250  -0.085 [1.322]  0.0002  0.6761\nFgra   0.660   0.325   0.410 [0.912]  <.0001\nFmer   0.145  -0.190  -0.105  -0.515 [1.427]\n\nRow and column labels: especie\nUpper triangle: P values   adjust = \"tukey\"\nDiagonal: [Estimates] (emmean) \nLower triangle: Comparisons (estimate)   earlier vs. later\n```\n\n\n:::\n:::\n\n\n\n\n\n## ANOVA fatorial (two-way ANOVA)\n\nA ANOVA fatorial é utilizada quando há duas ou mais variáveis independentes (fatores), cada uma com dois ou mais níveis. Ela é apropriada para experimentos fatoriais completos, nos quais todas as combinações possíveis entre os níveis dos fatores são testadas. Além de avaliar os efeitos individuais de cada fator, essa análise também permite verificar se existe interação entre os fatores, ou seja, se o efeito de um fator depende dos níveis do outro.\n\n### Importando o conjunto de dados:\n\nBanco de dados utilizado: fungicida-vaso (conjunto de dados do dados diversos). Objeto nomeado como fung_vaso.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(readxl)\n\nfung_vaso <- read_xlsx(\"dados-diversos.xlsx\", sheet = \"fungicida_vaso\")\n```\n:::\n\n\n\n\n\n**`factor(dose)`**: converte a variável `dose` em fator (categórica);\n\n**`severity * 100`**: transforma a variável de severidade em percentual;\n\n**`geom_jitter()`**: mostra os pontos com leve deslocamento horizontal, evitando sobreposição;\n\n**`facet_wrap(~ treat)`**: separa os gráficos por tratamento (`treat`).\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfung_vaso |> \n  ggplot(aes(factor(dose), severity*100))+ #transformando dose em um fator e ##transformar para percentual *100\n  geom_jitter(width = 0.1)+\n  facet_wrap(~ treat)\n```\n\n::: {.cell-output-display}\n![](anova_files/figure-html/unnamed-chunk-19-1.png){width=672}\n:::\n:::\n\n\n\n\n\n### Modelo linear com interação\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm_anti <- lm(severity ~ treat * dose, data = fung_vaso)\nanova(m_anti)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Variance Table\n\nResponse: severity\n           Df   Sum Sq  Mean Sq F value    Pr(>F)    \ntreat       1 0.113232 0.113232  30.358 4.754e-05 ***\ndose        1 0.073683 0.073683  19.755 0.0004077 ***\ntreat:dose  1 0.072739 0.072739  19.502 0.0004326 ***\nResiduals  16 0.059678 0.003730                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\n\n\n\n#### Checagem das premissas e visualização com DHARMa:\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(DHARMa)\nplot(simulateResiduals(m_anti))\n```\n\n::: {.cell-output-display}\n![](anova_files/figure-html/unnamed-chunk-21-1.png){width=672}\n:::\n:::\n\n\n\n\n\n#### Médias ajustadas com `emmeans`\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmedia_anti <- emmeans(m_anti, ~ treat | dose)\nmedia_anti\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\ndose = 0.5:\n treat        emmean     SE df lower.CL upper.CL\n Ionic liquid 0.2921 0.0273 16  0.23420   0.3500\n Tebuconazole 0.0210 0.0273 16 -0.03690   0.0789\n\ndose = 2.0:\n treat        emmean     SE df lower.CL upper.CL\n Ionic liquid 0.0501 0.0273 16 -0.00781   0.1080\n Tebuconazole 0.0202 0.0273 16 -0.03768   0.0781\n\nConfidence level used: 0.95 \n```\n\n\n:::\n:::\n\n\n\n\n\n#### Comparações múltiplas\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncld(media_anti)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\ndose = 0.5:\n treat        emmean     SE df lower.CL upper.CL .group\n Tebuconazole 0.0210 0.0273 16 -0.03690   0.0789  1    \n Ionic liquid 0.2921 0.0273 16  0.23420   0.3500   2   \n\ndose = 2.0:\n treat        emmean     SE df lower.CL upper.CL .group\n Tebuconazole 0.0202 0.0273 16 -0.03768   0.0781  1    \n Ionic liquid 0.0501 0.0273 16 -0.00781   0.1080  1    \n\nConfidence level used: 0.95 \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n\n\n:::\n:::\n\n\n\n\n\n##### Agora inverte: médias de doses dentro de tratamentos\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmedia_anti <- emmeans(m_anti, ~ dose | treat)\nmedia_anti\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\ntreat = Ionic liquid:\n dose emmean     SE df lower.CL upper.CL\n  0.5 0.2921 0.0273 16  0.23420   0.3500\n  2.0 0.0501 0.0273 16 -0.00781   0.1080\n\ntreat = Tebuconazole:\n dose emmean     SE df lower.CL upper.CL\n  0.5 0.0210 0.0273 16 -0.03690   0.0789\n  2.0 0.0202 0.0273 16 -0.03768   0.0781\n\nConfidence level used: 0.95 \n```\n\n\n:::\n\n```{.r .cell-code}\ncld(media_anti)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\ntreat = Ionic liquid:\n dose emmean     SE df lower.CL upper.CL .group\n  2.0 0.0501 0.0273 16 -0.00781   0.1080  1    \n  0.5 0.2921 0.0273 16  0.23420   0.3500   2   \n\ntreat = Tebuconazole:\n dose emmean     SE df lower.CL upper.CL .group\n  2.0 0.0202 0.0273 16 -0.03768   0.0781  1    \n  0.5 0.0210 0.0273 16 -0.03690   0.0789  1    \n\nConfidence level used: 0.95 \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n\n\n:::\n:::\n\n\n\n\n\n#### Coeficiente de variação\n\nEssa função do pacote `agricolae` calcula o coeficiente de variação (CV%) do modelo.\n\nAjuda a avaliar a precisão experimental. Valores abaixo de 20% geralmente são considerados bons (mas depende do contexto).\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(agricolae)\ncv.model(m_anti)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 63.7165\n```\n\n\n:::\n:::\n\n\n\n\n\n#### E se não houver interação significativa?\n\nMostra os efeitos **individuais de dose e tratamento**, ignorando a interação.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(patchwork)\n\np1 <- fung_vaso |> \n  ggplot(aes(factor(dose), severity*100)) + \n  geom_jitter(width = 0.1)\np2 <- fung_vaso |> \n  ggplot(aes(treat, severity*100)) + \n  geom_jitter(width = 0.1)\np1 + p2\n```\n\n::: {.cell-output-display}\n![](anova_files/figure-html/unnamed-chunk-26-1.png){width=672}\n:::\n:::\n\n\n\n\n\n#### Visualização da interação\n\n-   Gera um gráfico de interação;\n\n-   Se as linhas forem paralelas, não há interação;\n\n-   Se forem cruzadas ou afastadas, pode indicar interação.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ninteraction.plot(fung_vaso$treat, fung_vaso$dose, fung_vaso$severity)\n```\n\n::: {.cell-output-display}\n![](anova_files/figure-html/unnamed-chunk-27-1.png){width=672}\n:::\n:::\n\n\n\n\n\nTabela\n\n|          | 0.5     | 0.2    |\n|----------|---------|--------|\n| LI       | 29.2 Aa | 5.0 Ab |\n| TEBU     | 2.1 Ba  | 2.0 Aa |\n| cv = 63% |         |        |\n\n### Exemplo:\n\n#### Pacote `epifitter` e dados:\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#install.packages(\"epifitter\")\nlibrary(epifitter)\noidio <- PowderyMildew\n```\n:::\n\n\n\n\n\n#### Visualização dos dados filtrados\n\nFiltra apenas 3 tipos de irrigação.\n\n`sev*100`: transforma a severidade (que vai de 0 a 1) para percentual (0–100%).\n\n`facet_grid(moisture ~ irrigation_type)`: cria um painel com um gráfico para cada combinação de `moisture` (umidade) e `irrigation_type` (tipo de irrigação).\n\nO gráfico mostra como a doença evolui ao longo do tempo (`time`).\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\noidio |> \n  filter(irrigation_type %in% c(\"MS\", \"MS above canopy\", \"Overhead\")) |> \n  ggplot(aes(time, sev*100)) + \n  geom_jitter(width = 0.1) +\n  facet_grid(moisture ~ irrigation_type)\n```\n\n::: {.cell-output-display}\n![](anova_files/figure-html/unnamed-chunk-29-1.png){width=672}\n:::\n:::\n\n\n\n\n\n#### Cálculo da AUDPC (Área Abaixo da Curva de Progresso da Doença)\n\n`group_by(...)` agrupa os dados por tratamento (irrigação, umidade e bloco);\n\n`AUDPC(...)` calcula a área abaixo da curva para cada grupo;\n\nA AUDPC resume a intensidade da doença ao longo do tempo.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\nlibrary(epifitter)\n\noidio3 <- oidio |>\n  group_by(irrigation_type, moisture, block) |>\n  summarise(AUDPC = AUDPC(time, sev), .groups = \"drop\")\n```\n:::\n\n\n\n\n\n#### Visualizando a AUDPC\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\noidio3 |> \n  filter(irrigation_type %in% c(\"MS\", \"MS above canopy\", \"Overhead\")) |>\n  ggplot(aes(irrigation_type, AUDPC, color = moisture)) +\n  geom_point(width = 0.1) +\n  scale_y_continuous(limits = c(0, 20))\n```\n\n::: {.cell-output-display}\n![](anova_files/figure-html/unnamed-chunk-31-1.png){width=672}\n:::\n:::\n\n\n\n\n\n#### ANOVA fatorial (efeito da irrigação e umidade na AUDPC)\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\noidio4 <- oidio3 |> \n  filter(irrigation_type %in% c(\"MS\", \"MS above canopy\", \"Overhead\"))\n\nanov_oidio <- lm(AUDPC ~ irrigation_type * moisture, data = oidio4)\nanova(anov_oidio)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Variance Table\n\nResponse: AUDPC\n                         Df  Sum Sq Mean Sq F value    Pr(>F)    \nirrigation_type           2 134.341  67.170 451.721 5.073e-12 ***\nmoisture                  1   6.680   6.680  44.924 2.188e-05 ***\nirrigation_type:moisture  2   5.104   2.552  17.162 0.0003022 ***\nResiduals                12   1.784   0.149                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\n\n\n\n#### Diagnóstico do modelo\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(simulateResiduals(anov_oidio))\n```\n\n::: {.cell-output-display}\n![](anova_files/figure-html/unnamed-chunk-33-1.png){width=672}\n:::\n:::\n\n\n\n\n\n#### Médias ajustadas com `emmeans`\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmedias_oidio <- emmeans(anov_oidio, ~ irrigation_type | moisture)\nmedias_oidio\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nmoisture = High moisture:\n irrigation_type emmean    SE df lower.CL upper.CL\n MS                8.52 0.223 12     8.04     9.01\n MS above canopy   3.99 0.223 12     3.51     4.48\n Overhead          3.68 0.223 12     3.20     4.17\n\nmoisture = Moderate moisture:\n irrigation_type emmean    SE df lower.CL upper.CL\n MS               11.18 0.223 12    10.70    11.67\n MS above canopy   4.86 0.223 12     4.37     5.34\n Overhead          3.81 0.223 12     3.33     4.30\n\nConfidence level used: 0.95 \n```\n\n\n:::\n\n```{.r .cell-code}\ncld(medias_oidio)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nmoisture = High moisture:\n irrigation_type emmean    SE df lower.CL upper.CL .group\n Overhead          3.68 0.223 12     3.20     4.17  1    \n MS above canopy   3.99 0.223 12     3.51     4.48  1    \n MS                8.52 0.223 12     8.04     9.01   2   \n\nmoisture = Moderate moisture:\n irrigation_type emmean    SE df lower.CL upper.CL .group\n Overhead          3.81 0.223 12     3.33     4.30  1    \n MS above canopy   4.86 0.223 12     4.37     5.34   2   \n MS               11.18 0.223 12    10.70    11.67    3  \n\nConfidence level used: 0.95 \nP value adjustment: tukey method for comparing a family of 3 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n\n\n:::\n:::\n\n\n\n\n\nAgora, inverte: mostra as médias de umidade dentro de cada tipo de irrigação.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmedias_oidio2 <- emmeans(anov_oidio, ~ moisture | irrigation_type)\nmedias_oidio2\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nirrigation_type = MS:\n moisture          emmean    SE df lower.CL upper.CL\n High moisture       8.52 0.223 12     8.04     9.01\n Moderate moisture  11.18 0.223 12    10.70    11.67\n\nirrigation_type = MS above canopy:\n moisture          emmean    SE df lower.CL upper.CL\n High moisture       3.99 0.223 12     3.51     4.48\n Moderate moisture   4.86 0.223 12     4.37     5.34\n\nirrigation_type = Overhead:\n moisture          emmean    SE df lower.CL upper.CL\n High moisture       3.68 0.223 12     3.20     4.17\n Moderate moisture   3.81 0.223 12     3.33     4.30\n\nConfidence level used: 0.95 \n```\n\n\n:::\n\n```{.r .cell-code}\ncld(medias_oidio2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nirrigation_type = MS:\n moisture          emmean    SE df lower.CL upper.CL .group\n High moisture       8.52 0.223 12     8.04     9.01  1    \n Moderate moisture  11.18 0.223 12    10.70    11.67   2   \n\nirrigation_type = MS above canopy:\n moisture          emmean    SE df lower.CL upper.CL .group\n High moisture       3.99 0.223 12     3.51     4.48  1    \n Moderate moisture   4.86 0.223 12     4.37     5.34   2   \n\nirrigation_type = Overhead:\n moisture          emmean    SE df lower.CL upper.CL .group\n High moisture       3.68 0.223 12     3.20     4.17  1    \n Moderate moisture   3.81 0.223 12     3.33     4.30  1    \n\nConfidence level used: 0.95 \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n\n\n:::\n:::\n\n\n\n\n\n#### Coeficiente de variação do modelo\n\nIndica a precisão do experimento - valores menores geralmente indicam maior confiabilidade\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncv.model(anov_oidio)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 6.418205\n```\n\n\n:::\n:::\n\n\n\n\n\nTabela\n\n|           | H. moisture | M. moisture |\n|-----------|-------------|-------------|\n| MS        | 8.52 Aa     | 11.18 Ab    |\n| MS Ac.    | 3.99 Ba     | 4.86 Bb     |\n| Overhead  | 3.68 Ba     | 3.81 Ca     |\n| CV = 6.41 |             |             |\n\n## Anova Fatorial - 3 Fatores\n\n### Exemplo:\n\nDados sobre a interação entre tipo de armazenamento e umidade.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmilho <- read_excel(\"dados-diversos.xlsx\", \"armazena\")\nmilho |>\n  filter(tempo ==8) |>\n  ggplot(aes(factor(tipo), peso_mil,\n             color = factor(umidade)))+\n  geom_jitter(width = 0.1)+\n  facet_wrap(~ umidade)\n```\n\n::: {.cell-output-display}\n![](anova_files/figure-html/unnamed-chunk-37-1.png){width=672}\n:::\n:::\n\n\n\n\n\nTestar a interação entre o tipo de armazenamento e o tempo 8\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmilho2 <- milho |>\n  filter(tempo ==8)\n\nm2 <- aov(peso_mil ~ factor(tipo)*factor(umidade),\n          data = milho2)\nsummary(m2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                             Df Sum Sq Mean Sq F value   Pr(>F)    \nfactor(tipo)                  1  11215   11215  2375.8 3.64e-15 ***\nfactor(umidade)               2  42814   21407  4534.8  < 2e-16 ***\nfactor(tipo):factor(umidade)  2   2329    1165   246.7 1.79e-10 ***\nResiduals                    12     57       5                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\n\n\n\nTestanto tipo de inoculação na incidencia de *Fusarium* sp. em milho\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmilho3 <- read_excel(\"dados-diversos.xlsx\", \"milho\")\n\nm4 <- aov(yield ~hybrid*method,\n          data = milho3)\nsummary(m4)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n              Df    Sum Sq  Mean Sq F value   Pr(>F)    \nhybrid         5 105876446 21175289   8.312 2.66e-05 ***\nmethod         1     42951    42951   0.017    0.897    \nhybrid:method  5  10619453  2123891   0.834    0.534    \nResiduals     36  91709593  2547489                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\n\n\n\nChecagem das premissas\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncheck_heteroscedasticity(m4)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nOK: Error variance appears to be homoscedastic (p = 0.928).\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(simulateResiduals(m4))\n```\n\n::: {.cell-output-display}\n![](anova_files/figure-html/unnamed-chunk-41-1.png){width=672}\n:::\n:::\n\n\n\n\n\nMédias ajustadas com `emmeans`\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmedias_m4 <- emmeans(m4, ~ hybrid)\nmedias_m4\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n hybrid   emmean  SE df lower.CL upper.CL\n 30F53 HX  10598 564 36     9453    11742\n 30F53 YH   9309 564 36     8165    10454\n 30K64     11018 564 36     9874    12162\n 30S31H     8652 564 36     7507     9796\n 30S31YH    8056 564 36     6912     9201\n BG7049H   12402 564 36    11257    13546\n\nResults are averaged over the levels of: method \nConfidence level used: 0.95 \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncld(medias_m4)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n hybrid   emmean  SE df lower.CL upper.CL .group\n 30S31YH    8056 564 36     6912     9201  1    \n 30S31H     8652 564 36     7507     9796  12   \n 30F53 YH   9309 564 36     8165    10454  12   \n 30F53 HX  10598 564 36     9453    11742   23  \n 30K64     11018 564 36     9874    12162   23  \n BG7049H   12402 564 36    11257    13546    3  \n\nResults are averaged over the levels of: method \nConfidence level used: 0.95 \nP value adjustment: tukey method for comparing a family of 6 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n\n\n:::\n:::\n\n\n\n\n\nCaso a interação não dê sifnificativa, tira a interação e deixa só o fator que teve significancia (isola o fator)\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm5 <- aov(yield ~hybrid, data = milho3)\nsummary(m5)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n            Df    Sum Sq  Mean Sq F value   Pr(>F)    \nhybrid       5 105876446 21175289   8.688 1.02e-05 ***\nResiduals   42 102371996  2437428                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nm4 <- aov(yield ~hybrid,\n          data = milho3)\nsummary(m5)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n            Df    Sum Sq  Mean Sq F value   Pr(>F)    \nhybrid       5 105876446 21175289   8.688 1.02e-05 ***\nResiduals   42 102371996  2437428                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncheck_heteroscedasticity(m5)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nOK: Error variance appears to be homoscedastic (p = 0.763).\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmedias_m5 <- emmeans(m5, ~hybrid)\nmedias_m5\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n hybrid   emmean  SE df lower.CL upper.CL\n 30F53 HX  10598 552 42     9484    11712\n 30F53 YH   9309 552 42     8195    10423\n 30K64     11018 552 42     9904    12132\n 30S31H     8652 552 42     7538     9765\n 30S31YH    8056 552 42     6942     9170\n BG7049H   12402 552 42    11288    13516\n\nConfidence level used: 0.95 \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncld(medias_m5)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n hybrid   emmean  SE df lower.CL upper.CL .group\n 30S31YH    8056 552 42     6942     9170  1    \n 30S31H     8652 552 42     7538     9765  12   \n 30F53 YH   9309 552 42     8195    10423  123  \n 30F53 HX  10598 552 42     9484    11712   234 \n 30K64     11018 552 42     9904    12132    34 \n BG7049H   12402 552 42    11288    13516     4 \n\nConfidence level used: 0.95 \nP value adjustment: tukey method for comparing a family of 6 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npwpm(medias_m5)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n         30F53 HX 30F53 YH   30K64  30S31H 30S31YH BG7049H\n30F53 HX  [10598]   0.5709  0.9942  0.1494  0.0254  0.2125\n30F53 YH     1288  [ 9309]  0.2643  0.9576  0.5999  0.0036\n30K64        -420    -1709 [11018]  0.0447  0.0059  0.4938\n30S31H       1946      658    2366 [ 8652]  0.9723  0.0003\n30S31YH      2541     1253    2962     595 [ 8056]  <.0001\nBG7049H     -1804    -3092   -1384   -3750   -4345 [12402]\n\nRow and column labels: hybrid\nUpper triangle: P values   adjust = \"tukey\"\nDiagonal: [Estimates] (emmean) \nLower triangle: Comparisons (estimate)   earlier vs. later\n```\n\n\n:::\n:::\n\n\n\n\n\n## **ANOVA com bloco**\n\n### **Anova com bloco - Delineamento em Blocos Casualizado (DBC)**\n\nO (DBC) envolve os três princípios da experimentação: repetição, casualização e controle local. Neste caso, as condições locais não são homogêneas e podem ter efeito significativo sobre os tratamentos.\n\n#### Carregando pacotes e dados\n\nUsando o conjunto de dados fungicida_campo\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(readxl)\nlibrary(Hmisc)\nfung_campo <- read_xlsx(\"dados-diversos.xlsx\", sheet = \"fungicida_campo\")\n```\n:::\n\n\n\n\n\n#### Gráfico de produção por tratamento\n\n`mutate(TRAT = factor(TRAT))`: transforma os tratamentos (TRAT) em fatores para garantir que o `ggplot` os trate como categorias.\n\n`geom_jitter`: mostra os dados de cada parcela/bloco, deslocados horizontalmente para evitar sobreposição.\n\n`stat_summary(fun.data = \"mean_cl_boot\")`: adiciona médias com intervalos de confiança via bootstrap.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfung_campo |> \n  mutate(TRAT = factor(TRAT)) |> \n  ggplot(aes(TRAT, PROD)) +\n  geom_jitter(width = 0.2) +\n  stat_summary(fun.data = \"mean_cl_boot\", colour = \"red\", width = 0.3)\n```\n\n::: {.cell-output-display}\n![](anova_files/figure-html/unnamed-chunk-51-1.png){width=672}\n:::\n:::\n\n\n\n\n\n#### Convertendo variáveis em fatores\n\nAqui, você transforma `TRAT` e `BLOCO` explicitamente em **fatores**, pois o R trata números como contínuos por padrão.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfung_campo$TRAT <- factor(fung_campo$TRAT)\nfung_campo$BLOCO <- factor(fung_campo$BLOCO)\n```\n:::\n\n\n\n\n\n#### **Modelo Anova com bloco**\n\nANOVA com efeito de blocos e tratamentos:\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nanova_campo <- lm(PROD ~ BLOCO + TRAT, data = fung_campo)\nanova(anova_campo)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Variance Table\n\nResponse: PROD\n          Df  Sum Sq Mean Sq F value Pr(>F)  \nBLOCO      3  105716   35239  0.2172 0.8833  \nTRAT       7 2994142  427735  2.6369 0.0402 *\nResiduals 21 3406384  162209                 \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\n\n\n\n#### Checagem das premissas\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(performance)\nlibrary(DHARMa)\ncheck_normality(anova_campo)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nOK: residuals appear as normally distributed (p = 0.542).\n```\n\n\n:::\n\n```{.r .cell-code}\ncheck_heteroscedasticity(anova_campo)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nOK: Error variance appears to be homoscedastic (p = 0.216).\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(DHARMa)\nplot(simulateResiduals(anova_campo))\n```\n\n::: {.cell-output-display}\n![](anova_files/figure-html/unnamed-chunk-55-1.png){width=672}\n:::\n:::\n\n\n\n\n\n#### Estimativa e comparação das médias dos tratamentos\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmeans_campo <- emmeans(anova_campo, ~ TRAT)\nmeans_campo\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n TRAT emmean  SE df lower.CL upper.CL\n 1      4219 201 21     3800     4638\n 2      4935 201 21     4516     5354\n 3      5110 201 21     4691     5529\n 4      5140 201 21     4722     5559\n 5      5122 201 21     4703     5541\n 6      5256 201 21     4838     5675\n 7      5128 201 21     4709     5546\n 8      5078 201 21     4659     5497\n\nResults are averaged over the levels of: BLOCO \nConfidence level used: 0.95 \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(multcomp)\ncld(means_campo)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n TRAT emmean  SE df lower.CL upper.CL .group\n 1      4219 201 21     3800     4638  1    \n 2      4935 201 21     4516     5354  12   \n 8      5078 201 21     4659     5497  12   \n 3      5110 201 21     4691     5529  12   \n 5      5122 201 21     4703     5541  12   \n 7      5128 201 21     4709     5546  12   \n 4      5140 201 21     4722     5559  12   \n 6      5256 201 21     4838     5675   2   \n\nResults are averaged over the levels of: BLOCO \nConfidence level used: 0.95 \nP value adjustment: tukey method for comparing a family of 8 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(means_campo)\n```\n\n::: {.cell-output-display}\n![](anova_files/figure-html/unnamed-chunk-58-1.png){width=672}\n:::\n\n```{.r .cell-code}\npwpp(means_campo)\n```\n\n::: {.cell-output-display}\n![](anova_files/figure-html/unnamed-chunk-58-2.png){width=672}\n:::\n\n```{.r .cell-code}\npwpm(means_campo)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n        1       2       3       4       5       6       7      8\n1  [4219]  0.2431  0.0793  0.0639  0.0728  0.0272  0.0699 0.0985\n2  -715.7  [4935]  0.9983  0.9953  0.9974  0.9429  0.9968 0.9995\n3  -890.5  -174.8  [5110]  1.0000  1.0000  0.9994  1.0000 1.0000\n4  -921.1  -205.4   -30.6  [5140]  1.0000  0.9999  1.0000 1.0000\n5  -902.7  -187.0   -12.2    18.4  [5122]  0.9997  1.0000 1.0000\n6 -1037.1  -321.4  -146.6  -116.0  -134.4  [5256]  0.9998 0.9981\n7  -908.4  -192.7   -17.9    12.7    -5.7   128.7  [5128] 1.0000\n8  -859.0  -143.3    31.5    62.1    43.7   178.0    49.4 [5078]\n\nRow and column labels: TRAT\nUpper triangle: P values   adjust = \"tukey\"\nDiagonal: [Estimates] (emmean) \nLower triangle: Comparisons (estimate)   earlier vs. later\n```\n\n\n:::\n:::\n\n\n\n\n\nAnálise da Severidade da Ferrugem (`FER`):\n\n#### ANOVA com transformação logarítmica\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nanova_fer <- lm(log(FER) ~ BLOCO + TRAT, data = fung_campo)\nanova(anova_fer)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Variance Table\n\nResponse: log(FER)\n          Df  Sum Sq Mean Sq F value    Pr(>F)    \nBLOCO      3  0.2064 0.06880  1.7961    0.1788    \nTRAT       7 11.5210 1.64585 42.9665 4.838e-11 ***\nResiduals 21  0.8044 0.03831                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\n\n\n\n#### Diagnóstico do modelo\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(simulateResiduals(anova_fer))\n```\n\n::: {.cell-output-display}\n![](anova_files/figure-html/unnamed-chunk-60-1.png){width=672}\n:::\n:::\n\n\n\n\n\n#### Médias com back-transformation\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmeans_fer <- emmeans(anova_fer, ~ TRAT, type = \"response\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncld(means_fer)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n TRAT response    SE df lower.CL upper.CL .group\n 6        2.98 0.292 21     2.43     3.65  1    \n 4        3.08 0.301 21     2.51     3.78  1    \n 5        3.24 0.317 21     2.64     3.97  1    \n 7        3.37 0.330 21     2.75     4.13  1    \n 8        3.48 0.341 21     2.84     4.27  1    \n 3        3.81 0.373 21     3.11     4.67  12   \n 2        5.68 0.556 21     4.63     6.96   2   \n 1       20.02 1.960 21    16.33    24.54    3  \n\nResults are averaged over the levels of: BLOCO \nConfidence level used: 0.95 \nIntervals are back-transformed from the log scale \nP value adjustment: tukey method for comparing a family of 8 estimates \nTests are performed on the log scale \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n\n\n:::\n\n```{.r .cell-code}\nplot(means_fer)\n```\n\n::: {.cell-output-display}\n![](anova_files/figure-html/unnamed-chunk-62-1.png){width=672}\n:::\n\n```{.r .cell-code}\npwpp(means_fer)\n```\n\n::: {.cell-output-display}\n![](anova_files/figure-html/unnamed-chunk-62-2.png){width=672}\n:::\n\n```{.r .cell-code}\npwpm(means_fer)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n        1       2       3       4       5       6       7       8\n1 [20.02]  <.0001  <.0001  <.0001  <.0001  <.0001  <.0001  <.0001\n2   3.525 [ 5.68]  0.1252  0.0048  0.0110  0.0028  0.0204  0.0343\n3   5.259   1.492 [ 3.81]  0.7832  0.9335  0.6440  0.9843  0.9976\n4   6.500   1.844   1.236 [ 3.08]  0.9999  1.0000  0.9976  0.9842\n5   6.178   1.753   1.175   0.951 [ 3.24]  0.9984  1.0000  0.9994\n6   6.721   1.906   1.278   1.034   1.088 [ 2.98]  0.9842  0.9431\n7   5.945   1.686   1.130   0.915   0.962   0.885 [ 3.37]  1.0000\n8   5.750   1.631   1.093   0.885   0.931   0.856   0.967 [ 3.48]\n\nRow and column labels: TRAT\nUpper triangle: P values   null = 1  adjust = \"tukey\"\nDiagonal: [Estimates] (response)   type = \"response\"\nLower triangle: Comparisons (ratio)   earlier vs. later\n```\n\n\n:::\n:::\n\n\n\n\n\n## **Delineamento em parcela subdividida (*Split-plot*)**\n\n### Importando o conjunto de dados:\n\nExemplo:\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmilho <- read_excel(\"dados-diversos.xlsx\", \"milho\")\n```\n:::\n\n\n\n\n\n#### Visualizando os dados\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmilho |> \n  \n  ggplot(aes(hybrid, index, color = method))+\n  geom_jitter(width = 0.1)+\n coord_flip()\n```\n\n::: {.cell-output-display}\n![](anova_files/figure-html/unnamed-chunk-64-1.png){width=672}\n:::\n:::\n\n\n\n\n\n#### **Ajustando o modelo**:\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\naov_milho_bloco <- aov(index ~ factor(block) + hybrid*method + \nError(factor(block)/hybrid/method), data = milho)\n\nsummary(aov_milho_bloco)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nError: factor(block)\n              Df Sum Sq Mean Sq\nfactor(block)  3  592.2   197.4\n\nError: factor(block):hybrid\n          Df Sum Sq Mean Sq F value Pr(>F)  \nhybrid     5  974.2  194.84    3.14 0.0389 *\nResiduals 15  930.9   62.06                 \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nError: factor(block):hybrid:method\n              Df Sum Sq Mean Sq F value Pr(>F)  \nmethod         1  79.61   79.61   4.726 0.0433 *\nhybrid:method  5 265.28   53.06   3.150 0.0324 *\nResiduals     18 303.18   16.84                 \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\n\n\n\n#### **Checagem das premissas**\n\nEm parcelas subdivididas não é possível checar as premissas pelo check\\_, então usa lme4, para checar pelo modelo misto.\n\n##### **Pacote “lme4”**\n\nAjusta modelos de efeitos mistos lineares e lineares generalizados. Os modelos e seus componentes são representados usando classes e métodos S4.\n\n##### **Função “lmer”**\n\nGera um componente aleatório que é específico a cada indivíduo, de modo que podemos ter, para cada um, um intercepto e uma inclinação distintas.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(Matrix)\nlibrary(lme4)\nmilho$block <- as.factor(milho$block)\nmix2 <- lmer(index ~ block + hybrid*method + \n(1|block/hybrid), data =  milho)\n\nlibrary(car)\nAnova(mix2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Deviance Table (Type II Wald chisquare tests)\n\nResponse: index\n                Chisq Df Pr(>Chisq)   \nblock          0.3192  3   0.956380   \nhybrid        15.6987  5   0.007759 **\nmethod         4.7262  1   0.029706 * \nhybrid:method 15.7498  5   0.007596 **\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncheck_normality(mix2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nOK: residuals appear as normally distributed (p = 0.621).\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncheck_heteroscedasticity(mix2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nWarning: Heteroscedasticity (non-constant error variance) detected (p = 0.009).\n```\n\n\n:::\n:::\n\n\n\n\n\n#### Necessário transformar os dados\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmilho$block <- as.factor(milho$block)\nmix2 <- lmer(sqrt(index) ~ block + hybrid*method + (1|block/hybrid), data = milho)\nlibrary(car)\nAnova(mix2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Deviance Table (Type II Wald chisquare tests)\n\nResponse: sqrt(index)\n                Chisq Df Pr(>Chisq)   \nblock          0.0764  3   0.994506   \nhybrid        15.4171  5   0.008721 **\nmethod         3.9239  1   0.047605 * \nhybrid:method 13.3025  5   0.020703 * \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\n\n\n\n##### Checagem\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncheck_normality(mix2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nOK: residuals appear as normally distributed (p = 0.422).\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncheck_heteroscedasticity(mix2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nOK: Error variance appears to be homoscedastic (p = 0.970).\n```\n\n\n:::\n:::\n\n\n\n\n\n#### **Comparação de médias**\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmeans_mix2 <- emmeans(mix2, ~hybrid | method)\nmeans_mix2\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nmethod = pin:\n hybrid   emmean   SE   df lower.CL upper.CL\n 30F53 HX   5.00 1.17 5356     2.69     7.30\n 30F53 YH   4.95 1.17 5356     2.65     7.25\n 30K64      4.50 1.17 5356     2.20     6.81\n 30S31H     6.10 1.17 5356     3.79     8.40\n 30S31YH    5.63 1.17 5356     3.33     7.93\n BG7049H    4.40 1.17 5356     2.10     6.71\n\nmethod = silk:\n hybrid   emmean   SE   df lower.CL upper.CL\n 30F53 HX   4.94 1.17 5356     2.64     7.25\n 30F53 YH   5.10 1.17 5356     2.80     7.41\n 30K64      4.61 1.17 5356     2.31     6.91\n 30S31H     5.13 1.17 5356     2.83     7.43\n 30S31YH    5.14 1.17 5356     2.84     7.44\n BG7049H    4.37 1.17 5356     2.07     6.67\n\nResults are averaged over the levels of: block \nDegrees-of-freedom method: kenward-roger \nResults are given on the sqrt (not the response) scale. \nConfidence level used: 0.95 \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncld(means_mix2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nmethod = pin:\n hybrid   emmean   SE   df lower.CL upper.CL .group\n BG7049H    4.40 1.17 5356     2.10     6.71  1    \n 30K64      4.50 1.17 5356     2.20     6.81  1    \n 30F53 YH   4.95 1.17 5356     2.65     7.25  12   \n 30F53 HX   5.00 1.17 5356     2.69     7.30  12   \n 30S31YH    5.63 1.17 5356     3.33     7.93  12   \n 30S31H     6.10 1.17 5356     3.79     8.40   2   \n\nmethod = silk:\n hybrid   emmean   SE   df lower.CL upper.CL .group\n BG7049H    4.37 1.17 5356     2.07     6.67  1    \n 30K64      4.61 1.17 5356     2.31     6.91  1    \n 30F53 HX   4.94 1.17 5356     2.64     7.25  1    \n 30F53 YH   5.10 1.17 5356     2.80     7.41  1    \n 30S31H     5.13 1.17 5356     2.83     7.43  1    \n 30S31YH    5.14 1.17 5356     2.84     7.44  1    \n\nResults are averaged over the levels of: block \nDegrees-of-freedom method: kenward-roger \nResults are given on the sqrt (not the response) scale. \nConfidence level used: 0.95 \nNote: contrasts are still on the sqrt scale. Consider using\n      regrid() if you want contrasts of back-transformed estimates. \nP value adjustment: tukey method for comparing a family of 6 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n\n\n:::\n:::\n",
    "supporting": [
      "anova_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}